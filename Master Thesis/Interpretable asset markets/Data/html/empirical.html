
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>empirical</title><meta name="generator" content="MATLAB 8.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2017-09-13"><meta name="DC.source" content="empirical.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#1">Empirical</a></li><li><a href="#2">Summary statistics</a></li><li><a href="#3">Table 2</a></li><li><a href="#4">Table 3</a></li><li><a href="#5">Figure 1</a></li><li><a href="#6">table 4</a></li><li><a href="#7">Table 5</a></li><li><a href="#8">Table 6</a></li></ul></div><h2>Empirical<a name="1"></a></h2><h2>Summary statistics<a name="2"></a></h2><img vspace="5" hspace="5" src="empirical_01.png" alt=""> <h2>Table 2<a name="3"></a></h2><pre class="codeoutput"> 
    ARIMA(1,0,0) Model:
    --------------------
    Conditional Probability Distribution: Gaussian

                                  Standard          t     
     Parameter       Value          Error       Statistic 
    -----------   -----------   ------------   -----------
     Constant     0.00697646   0.000526012        13.2629
        AR{1}       0.195556     0.0530574        3.68574
     Variance    2.42008e-05   1.74301e-06        13.8845
 
    ARIMA(1,0,0) Model:
    --------------------
    Conditional Probability Distribution: Gaussian

                                  Standard          t     
     Parameter       Value          Error       Statistic 
    -----------   -----------   ------------   -----------
     Constant      0.0199532     0.0062261        3.20476
        AR{1}      0.0779554     0.0649359         1.2005
     Variance     0.00600511   0.000473208        12.6902
 
    ARIMA(1,0,0) Model:
    --------------------
    Conditional Probability Distribution: Gaussian

                                  Standard          t     
     Parameter       Value          Error       Statistic 
    -----------   -----------   ------------   -----------
     Constant     0.00700651   0.000831304        8.42834
        AR{1}        0.19454     0.0841556        2.31168
 
 
    GARCH(1,1) Conditional Variance Model:
    ----------------------------------------
    Conditional Probability Distribution: Gaussian

                                  Standard          t     
     Parameter       Value          Error       Statistic 
    -----------   -----------   ------------   -----------
     Constant    1.39159e-05   4.14519e-06        3.35712
     GARCH{1}       0.127887      0.237493       0.538487
      ARCH{1}       0.297326      0.115287        2.57902
 
    ARIMA(1,0,0) Model:
    --------------------
    Conditional Probability Distribution: Gaussian

                                  Standard          t     
     Parameter       Value          Error       Statistic 
    -----------   -----------   ------------   -----------
     Constant      0.0193859     0.0065259         2.9706
        AR{1}       0.101148     0.0935808        1.08086
 
 
    GARCH(1,1) Conditional Variance Model:
    ----------------------------------------
    Conditional Probability Distribution: Gaussian

                                  Standard          t     
     Parameter       Value          Error       Statistic 
    -----------   -----------   ------------   -----------
     Constant     0.00204175    0.00144054        1.41735
     GARCH{1}       0.525254      0.281542        1.86564
      ARCH{1}       0.141232     0.0815079        1.73273
</pre><img vspace="5" hspace="5" src="empirical_02.png" alt=""> <img vspace="5" hspace="5" src="empirical_03.png" alt=""> <h2>Table 3<a name="4"></a></h2><img vspace="5" hspace="5" src="empirical_04.png" alt=""> <img vspace="5" hspace="5" src="empirical_05.png" alt=""> <h2>Figure 1<a name="5"></a></h2><img vspace="5" hspace="5" src="empirical_06.png" alt=""> <h2>table 4<a name="6"></a></h2><img vspace="5" hspace="5" src="empirical_07.png" alt=""> <img vspace="5" hspace="5" src="empirical_08.png" alt=""> <h2>Table 5<a name="7"></a></h2><img vspace="5" hspace="5" src="empirical_09.png" alt=""> <img vspace="5" hspace="5" src="empirical_10.png" alt=""> <h2>Table 6<a name="8"></a></h2><img vspace="5" hspace="5" src="empirical_11.png" alt=""> <img vspace="5" hspace="5" src="empirical_12.png" alt=""> <p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Empirical
clear global

cd('J:\WISE\Ren yu\Interpretable asset markets\Data');
load('data_complete_deseasonallized_D.mat');


%% Summary statistics

f1 = figure('Name','Summary statistics','NumberTitle','off');

t = uitable(f1,'Data',table_data,'Position',[40 220 450 140]);
t.RowName = RowName;
t.ColumnName = ColumnName;


sub_t = uitable(f1,'Data',sub_table_data,'Position',[40 80 450 140]);
sub_t.RowName =  RowName;
sub_t.ColumnName = ColumnName;

%% Table 2

% Set up the random seed
rnd_seed = 20170906;
rng(rnd_seed);

AR = arima('ARlags', 1);

ARGARCH =  arima('ARLags',1,'Variance',garch(1,1));

[EstMdl_gc_AR,EstParamCov_gc_AR] = estimate(AR, full_data(:,2));

[EstMdl_rm_AR,EstParamCov_rm_AR] = estimate(AR, full_data(:,5));

[EstMdl_gc_ARGARCH,EstParamCov_gc_ARGARCH] = estimate(ARGARCH, full_data(:,2));

[EstMdl_rm_ARGARCH,EstParamCov_rm_ARGARCH] = estimate(ARGARCH, full_data(:,5));



[res_gc_AR] = infer(EstMdl_gc_AR,full_data(:,2));
[res_rm_AR] = infer(EstMdl_rm_AR,full_data(:,5));

AC_AR(:,1) = autocorr(abs(res_gc_AR));
AC_AR(:,2) = autocorr(abs(res_rm_AR));

AC_AR([2,5,8],:);

[h_gc, pValue_gc, stat_gc] = lbqtest(abs(res_gc_AR),'lags',[1,4,8]);

[h_rm, pValue_rm, stat_rm] = lbqtest(abs(res_rm_AR),'lags',[1,4,8]);

clf

[res_gc_AR2] = infer(EstMdl_gc_AR,full_data(:,2));

f2 = figure('Name','Consumption growth and market return projection','NumberTitle','off');


f2_data(1:19,1) = {'AR(1) estimates',[] ,'Panel A: Consumption growth','Estimate','S.E.'...
    ,[] ,'Panel B: Market return','Estimate','S.E.'...
    ,[] ,'AR(1)-GARCH(1,1) estimates',[] ,'Panel C: Consumption','Estimate','S.E.'...
    ,[] ,'Panel D: Market return','Estimate','S.E.'};

f2_data([4,5,8,9,14,15,18,19],2) = {EstMdl_gc_AR.Constant,sqrt(EstParamCov_gc_AR(1,1)),...
    EstMdl_rm_AR.Constant,sqrt(EstParamCov_rm_AR(1,1)),...
    EstMdl_gc_ARGARCH.Constant,sqrt(EstParamCov_gc_ARGARCH(1,1)),...
    EstMdl_rm_ARGARCH.Constant,sqrt(EstParamCov_rm_ARGARCH(1,1))};

f2_data([4,5,8,9,14,15,18,19],3) = {EstMdl_gc_AR.AR{1},sqrt(EstParamCov_gc_AR(2,2)),...
    EstMdl_rm_AR.AR{1},sqrt(EstParamCov_rm_AR(2,2)),...
    EstMdl_gc_ARGARCH.AR{1},sqrt(EstParamCov_gc_ARGARCH(2,2)),...
    EstMdl_rm_ARGARCH.AR{1},sqrt(EstParamCov_rm_ARGARCH(2,2))};

f2_data([14,15,18,19],4) = ...
    {EstMdl_gc_ARGARCH.Variance.Constant,sqrt(EstParamCov_gc_ARGARCH(3,3)),...
    EstMdl_rm_ARGARCH.Variance.Constant,sqrt(EstParamCov_rm_ARGARCH(3,3))};

f2_data([14,15,18,19],5) = ...
    {EstMdl_gc_ARGARCH.Variance.ARCH{1},sqrt(EstParamCov_gc_ARGARCH(5,5)),...
    EstMdl_rm_ARGARCH.Variance.ARCH{1},sqrt(EstParamCov_rm_ARGARCH(5,5))};

f2_data([14,15,18,19],6) = ...
    {EstMdl_gc_ARGARCH.Variance.GARCH{1},sqrt(EstParamCov_gc_ARGARCH(4,4)),...
    EstMdl_rm_ARGARCH.Variance.GARCH{1},sqrt(EstParamCov_rm_ARGARCH(4,4))};

f2_data([4,5,8,9],7) = {'Estimate','Q-stat','Estimate','Q-stat'};

f2_data(4,[8,9,10]) = {AC_AR(2,1) AC_AR(5,1) AC_AR(9,1)};
f2_data(8,[8,9,10]) = {AC_AR(2,2) AC_AR(5,2) AC_AR(9,2)};

f2_data(5,[8,9,10]) = {stat_gc(1)  stat_gc(2)  stat_gc(3)};
f2_data(9,[8,9,10]) = {stat_rm(1)  stat_rm(2)  stat_rm(3)};

f2.Position = [560,528,900,450];

table_2 = uitable(f2,'Data',f2_data,'Position',[40 30 715 385]);
table_2.Position = [40 30 775 385];

table_2.ColumnWidth = {150,65,65,65,65,65,65,65,65,65};
table_2.ColumnName = {[],'const','A1','w0','w1','w2',[],'AC(1)','AC(4)','AC(8)'};



%% Table 3


[res_gc_ARGARCH, v_gc_ARGARCH] = infer(EstMdl_gc_ARGARCH,full_data(:,2));
[res_rm_ARGARCH, v_rm_ARGARCH] = infer(EstMdl_rm_ARGARCH,full_data(:,5));


% full_reg_data.vc =  v_gc_ARGARCH;
% full_reg_data.vr_lag1 =  [nan; v_gc_ARGARCH(1:end-1)];
% full_reg_data.vr_lag4 =  [ones(4,1)*nan; v_gc_ARGARCH(1:end-4)];
% full_reg_data.vr_lag8 =  [ones(8,1)*nan; v_gc_ARGARCH(1:end-8)];
% 
% full_reg_data.vr =  v_rm_ARGARCH;
% full_reg_data.vr_lag1 =  [nan; v_rm_ARGARCH(1:end-1)];
% full_reg_data.vr_lag4 =  [ones(4,1)*nan; v_rm_ARGARCH(1:end-4)];
% full_reg_data.vr_lag8 =  [ones(8,1)*nan; v_rm_ARGARCH(1:end-8)];

% generate sigma

% gen_sigma_J is a function defined by me

res_gc_AR = abs(res_gc_AR);
res_rm_AR = abs(res_rm_AR);

full_reg_data.sigma_c_1 =  [nan; gen_sigma_J(res_gc_AR, 1)];
full_reg_data.sigma_c_4 =  [ones(4,1)*nan; gen_sigma_J(res_gc_AR, 4)];
full_reg_data.sigma_c_8  =  [ones(8,1)*nan;gen_sigma_J(res_gc_AR, 8)];

full_reg_data.sigma_r_1 =  [nan; gen_sigma_J(res_rm_AR, 1)];
full_reg_data.sigma_r_4 =  [ones(4,1)*nan; gen_sigma_J(res_rm_AR, 4)];
full_reg_data.sigma_r_8  =  [ones(8,1)*nan;gen_sigma_J(res_rm_AR, 8)];




pd_vc_1 = fitlm(full_reg_data,'p_min_d~sigma_c_1');
pd_vc_4 = fitlm(full_reg_data,'p_min_d~sigma_c_4');
pd_vc_8 = fitlm(full_reg_data,'p_min_d~sigma_c_8');

pd_vr_1 = fitlm(full_reg_data,'p_min_d~sigma_r_1');
pd_vr_4 = fitlm(full_reg_data,'p_min_d~sigma_r_4');
pd_vr_8 = fitlm(full_reg_data,'p_min_d~sigma_r_8');

pe_vc_1 = fitlm(full_reg_data,'p_min_e~sigma_c_1');
pe_vc_4 = fitlm(full_reg_data,'p_min_e~sigma_c_4');
pe_vc_8 = fitlm(full_reg_data,'p_min_e~sigma_c_8');

pe_vr_1 = fitlm(full_reg_data,'p_min_e~sigma_r_1');
pe_vr_4 = fitlm(full_reg_data,'p_min_e~sigma_r_4');
pe_vr_8 = fitlm(full_reg_data,'p_min_e~sigma_r_8');


% table 3
table_3_data = cell(9,14);
table_3_data([2:4,7:9],1) = num2cell([1,4,8,1,4,8]);
table_3_data([1,6],1) = {'Panel A: price-dividend ratio','Panel B: price-earnings ratio'};

table_3_data([2,3,4],[2,3,4]) = {...
    pd_vc_1.Coefficients.Estimate(2), pd_vc_1.Coefficients.tStat(2),pd_vc_1.Rsquared.Adjusted;...
    pd_vc_4.Coefficients.Estimate(2), pd_vc_4.Coefficients.tStat(2),pd_vc_4.Rsquared.Adjusted;...
    pd_vc_8.Coefficients.Estimate(2), pd_vc_8.Coefficients.tStat(2),pd_vc_8.Rsquared.Adjusted};

table_3_data([2,3,4],[9,10,11]) = {...
    pd_vr_1.Coefficients.Estimate(2), pd_vr_1.Coefficients.tStat(2),pd_vr_1.Rsquared.Adjusted;...
    pd_vr_4.Coefficients.Estimate(2), pd_vr_4.Coefficients.tStat(2),pd_vr_4.Rsquared.Adjusted;...
    pd_vr_8.Coefficients.Estimate(2), pd_vr_8.Coefficients.tStat(2),pd_vr_8.Rsquared.Adjusted};

table_3_data([7,8,9],[2,3,4]) = {...
    pe_vc_1.Coefficients.Estimate(2), pe_vc_1.Coefficients.tStat(2),pe_vc_1.Rsquared.Adjusted;...
    pe_vc_4.Coefficients.Estimate(2), pe_vc_4.Coefficients.tStat(2),pe_vc_4.Rsquared.Adjusted;...
    pe_vc_8.Coefficients.Estimate(2), pe_vc_8.Coefficients.tStat(2),pe_vc_8.Rsquared.Adjusted};

table_3_data([7,8,9],[9,10,11]) = {...
    pe_vr_1.Coefficients.Estimate(2), pe_vr_1.Coefficients.tStat(2),pe_vr_1.Rsquared.Adjusted;...
    pe_vr_4.Coefficients.Estimate(2), pe_vr_4.Coefficients.tStat(2),pe_vr_4.Rsquared.Adjusted;...
    pe_vr_8.Coefficients.Estimate(2), pe_vr_8.Coefficients.tStat(2),pe_vr_8.Rsquared.Adjusted};


clf

f3 = figure('Name','Economic uncertainty predicting future valuation ratios: USA','NumberTitle','off');


f3.Position = [560,528,1070,250];

table_3 = uitable(f3,'Data',table_3_data,'Position',[20 30 1030 200]);
table_3.Position = [20 30 1030 200];

table_3.ColumnWidth = {150,65,65,65,65,65,65,65,65,65,65,65,65,65};
table_3.ColumnName = {'J', 'b', 't-stat', 'R^2', 't(2.5%)','t(5%)','R^2(95%)',[], 'b', 't-stat', 'R^2', 't(2.5%)','t(5%)','R^2(95%)'};

%% Figure 1

clf

full_reg_data.sigma_c_12  =  [ones(12,1)*nan;gen_sigma_J(res_gc_AR, 12)];

subplot(2,1,1)
plot(zscore(full_reg_data.p_min_e(13:end)),'r')
hold on
plot(zscore(full_reg_data.sigma_c_12(13:end)),'b')
title(' Consumption Volatility against log price-earnings ratio');
legend('(p_t - e_t)','\sigma_{c,t-1,12}','Location','north')

subplot(2,1,2)
plot(zscore(full_reg_data.p_min_e(13:end)),'r')
hold on
plot(zscore(full_reg_data.g_e(13:end)-full_reg_data.g_e(1:end-12)),'b')
title(' 12 quarter earnings against log price-earnings ratio');
legend('(p_t - e_t)','(e_t - e_{t-12})','Location','north')


%% table 4


full_reg_data.abs_eta_c_1 = [abs(res_gc_AR(2:end)); nan];
full_reg_data.abs_eta_c_4 = [abs(res_gc_AR(5:end)); ones(4,1)*nan];
full_reg_data.abs_eta_c_8 = [abs(res_gc_AR(9:end)); ones(8,1)*nan];

full_reg_data.abs_eta_r_1 = [abs(res_rm_AR(2:end)); nan];
full_reg_data.abs_eta_r_4 = [abs(res_rm_AR(5:end)); ones(4,1)*nan];
full_reg_data.abs_eta_r_8 = [abs(res_rm_AR(9:end)); ones(8,1)*nan];


eta_c_pd_1 = fitlm(full_reg_data,'p_min_d~abs_eta_c_1');
eta_c_pd_4 = fitlm(full_reg_data,'p_min_d~abs_eta_c_4');
eta_c_pd_8 = fitlm(full_reg_data,'p_min_d~abs_eta_c_8');

eta_r_pd_1 = fitlm(full_reg_data,'p_min_d~abs_eta_r_1');
eta_r_pd_4 = fitlm(full_reg_data,'p_min_d~abs_eta_r_4');
eta_r_pd_8 = fitlm(full_reg_data,'p_min_d~abs_eta_r_8');

eta_c_pe_1 = fitlm(full_reg_data,'p_min_e~abs_eta_c_1');
eta_c_pe_4 = fitlm(full_reg_data,'p_min_e~abs_eta_c_4');
eta_c_pe_8 = fitlm(full_reg_data,'p_min_e~abs_eta_c_8');

eta_r_pe_1 = fitlm(full_reg_data,'p_min_e~abs_eta_r_1');
eta_r_pe_4 = fitlm(full_reg_data,'p_min_e~abs_eta_r_4');
eta_r_pe_8 = fitlm(full_reg_data,'p_min_e~abs_eta_r_8');


% table 4
table_4_data = cell(9,14);
table_4_data([2:4,7:9],1) = num2cell([1,4,8,1,4,8]);
table_4_data([1,6],1) = {'Panel A: price-dividend ratio','Panel B: price-earnings ratio'};

table_4_data([2,3,4],[2,3,4]) = {...
    eta_c_pd_1.Coefficients.Estimate(2), eta_c_pd_1.Coefficients.tStat(2),eta_c_pd_1.Rsquared.Adjusted;...
    eta_c_pd_4.Coefficients.Estimate(2), eta_c_pd_4.Coefficients.tStat(2),eta_c_pd_4.Rsquared.Adjusted;...
    eta_c_pd_8.Coefficients.Estimate(2), eta_c_pd_8.Coefficients.tStat(2),eta_c_pd_8.Rsquared.Adjusted};

table_4_data([2,3,4],[9,10,11]) = {...
    eta_r_pd_1.Coefficients.Estimate(2), eta_r_pd_1.Coefficients.tStat(2),eta_r_pd_1.Rsquared.Adjusted;...
    eta_r_pd_4.Coefficients.Estimate(2), eta_r_pd_4.Coefficients.tStat(2),eta_r_pd_4.Rsquared.Adjusted;...
    eta_r_pd_8.Coefficients.Estimate(2), eta_r_pd_8.Coefficients.tStat(2),eta_r_pd_8.Rsquared.Adjusted};

table_4_data([7,8,9],[2,3,4]) = {...
    eta_c_pe_1.Coefficients.Estimate(2), eta_c_pe_1.Coefficients.tStat(2),eta_c_pe_1.Rsquared.Adjusted;...
    eta_c_pe_4.Coefficients.Estimate(2), eta_c_pe_4.Coefficients.tStat(2),eta_c_pe_4.Rsquared.Adjusted;...
    eta_c_pe_8.Coefficients.Estimate(2), eta_c_pe_8.Coefficients.tStat(2),eta_c_pe_8.Rsquared.Adjusted};

table_4_data([7,8,9],[9,10,11]) = {...
    eta_r_pe_1.Coefficients.Estimate(2), eta_r_pe_1.Coefficients.tStat(2),eta_r_pe_1.Rsquared.Adjusted;...
    eta_r_pe_4.Coefficients.Estimate(2), eta_r_pe_4.Coefficients.tStat(2),eta_r_pe_4.Rsquared.Adjusted;...
    eta_r_pe_8.Coefficients.Estimate(2), eta_r_pe_8.Coefficients.tStat(2),eta_r_pe_8.Rsquared.Adjusted};


clf

f4 = figure('Name','Valuation ratios prediction future economic uncertainty: USA','NumberTitle','off');


f4.Position = [560,528,1070,250];

table_4 = uitable(f4,'Data',table_4_data,'Position',[20 30 1030 200]);
table_4.Position = [20 30 1030 200];

table_4.ColumnWidth = {150,65,65,65,65,65,65,65,65,65,65,65,65,65};
table_4.ColumnName = {'J', 'a', 't-stat', 'R^2', 't(2.5%)','t(5%)','R^2(95%)',[], 'a', 't-stat', 'R^2', 't(2.5%)','t(5%)','R^2(95%)'};


%% Table 5

full_reg_data.logvc = log(v_gc_ARGARCH);
full_reg_data.logvc_lag1 =  [nan;log(v_gc_ARGARCH(1:end-1))];
full_reg_data.p_min_e_lag1 =  [nan;log(full_reg_data.p_min_e(1:end-1))];


pe_logvc = fitlm(full_reg_data, 'p_min_e~logvc_lag1');

pe_ar_logvc = fitlm(full_reg_data, 'p_min_e~p_min_e_lag1+logvc_lag1');

logvc_pe = fitlm(full_reg_data, 'logvc~p_min_e_lag1');

logvc_ar_pe = fitlm(full_reg_data, 'logvc~p_min_e_lag1+logvc_lag1');


% table 5
table_5_data = cell(15,8);
table_5_data([1:3,5:7,9:11,13:15],1) = {'Panel A:Predicting price-earnings ratio','p_t - e_t = a0 + a1*log(sigma_c_t-1^2) + eps_t',...
    'a1', 'p_t - e_t = a0 +  a1*(p_t-1 - e_t-1)+ a2*log(sigma_c_t-1^2)  + eps_t','a2','a1',...
    'Panel B: Predicting volatility','log(sigma_c_t^2) = a0 + a1*(p_t-1 - e_t-1) + eps_t',...
    'a1', 'log(sigma_c_t^2) = a0 + a1*(p_t-1 - e_t-1) + a2*log(sigma_c_t-1^2) + eps_t'...
    'a1','a2'};

table_5_data(3,[2,3,4]) = {...
    pe_logvc.Coefficients.Estimate(2), pe_logvc.Coefficients.tStat(2),pe_logvc.Rsquared.Adjusted};

table_5_data([6,7],[2,3,4]) = {...
    pe_ar_logvc.Coefficients.Estimate(2), pe_ar_logvc.Coefficients.tStat(2), pe_ar_logvc.Rsquared.Adjusted;...
   pe_ar_logvc.Coefficients.Estimate(3), pe_ar_logvc.Coefficients.tStat(3),[]};

table_5_data(11,[2,3,4]) = {...
    logvc_pe.Coefficients.Estimate(2), logvc_pe.Coefficients.tStat(2),logvc_pe.Rsquared.Adjusted};

table_5_data([14,15],[2,3,4]) = {...
    logvc_ar_pe.Coefficients.Estimate(3),  logvc_ar_pe.Coefficients.tStat(3), logvc_ar_pe.Rsquared.Adjusted;...
     logvc_ar_pe.Coefficients.Estimate(2),  logvc_ar_pe.Coefficients.tStat(2), []};


clf

f5 = figure('Name','Price-earnings ratios and economic uncertainty: USA','NumberTitle','off');


f5.Position = [560,528,940,360];

table_5 = uitable(f5,'Data',table_5_data,'Position',[20 30 880 310]);
table_5.Position = [20 30 880 310];

table_5.ColumnWidth = {370,65,65,65,65,65,65,80};
table_5.ColumnName = {'J', 'a', 't-stat', 'R^2', 't(2.5%)','t(5%)','R^2(95%)','R^2(97.25%)'};


%% Table 6

full_reg_data.sum_ge_4 = [gen_sum_J(full_reg_data.g_e, 4); ones(4,1)*nan];
full_reg_data.sum_ge_8 = [gen_sum_J(full_reg_data.g_e, 8); ones(8,1)*nan];
full_reg_data.sum_ge_12 = [gen_sum_J(full_reg_data.g_e, 12); ones(12,1)*nan];
full_reg_data.sum_ge_16 = [gen_sum_J(full_reg_data.g_e, 16); ones(16,1)*nan];

full_reg_data.sum_gd_4 = [gen_sum_J(full_reg_data.g_d, 4); ones(4,1)*nan];
full_reg_data.sum_gd_8 = [gen_sum_J(full_reg_data.g_d, 8); ones(8,1)*nan];
full_reg_data.sum_gd_12 = [gen_sum_J(full_reg_data.g_d, 12); ones(12,1)*nan];
full_reg_data.sum_gd_16 = [gen_sum_J(full_reg_data.g_d, 16); ones(16,1)*nan];

full_reg_data.sum_rm_4 = [gen_sum_J(full_reg_data.r_m, 4); ones(4,1)*nan];
full_reg_data.sum_rm_8 = [gen_sum_J(full_reg_data.r_m, 8); ones(8,1)*nan];
full_reg_data.sum_rm_12 = [gen_sum_J(full_reg_data.r_m, 12); ones(12,1)*nan];
full_reg_data.sum_rm_16 = [gen_sum_J(full_reg_data.r_m, 16); ones(16,1)*nan];

% model

sum_ge_4_pd = fitlm(full_reg_data, 'sum_ge_4~p_min_d');
sum_ge_8_pd = fitlm(full_reg_data, 'sum_ge_8~p_min_d');
sum_ge_12_pd = fitlm(full_reg_data, 'sum_ge_12~p_min_d');
sum_ge_16_pd = fitlm(full_reg_data, 'sum_ge_16~p_min_d');

sum_gd_4_pd = fitlm(full_reg_data, 'sum_gd_4~p_min_d');
sum_gd_8_pd = fitlm(full_reg_data, 'sum_gd_8~p_min_d');
sum_gd_12_pd = fitlm(full_reg_data, 'sum_gd_12~p_min_d');
sum_gd_16_pd = fitlm(full_reg_data, 'sum_gd_16~p_min_d');

sum_rm_4_pd = fitlm(full_reg_data, 'sum_rm_4~p_min_d');
sum_rm_8_pd = fitlm(full_reg_data, 'sum_rm_8~p_min_d');
sum_rm_12_pd = fitlm(full_reg_data, 'sum_rm_12~p_min_d');
sum_rm_16_pd = fitlm(full_reg_data, 'sum_rm_16~p_min_d');

sum_ge_4_pe = fitlm(full_reg_data, 'sum_ge_4~p_min_e');
sum_ge_8_pe = fitlm(full_reg_data, 'sum_ge_8~p_min_e');
sum_ge_12_pe = fitlm(full_reg_data, 'sum_ge_12~p_min_e');
sum_ge_16_pe = fitlm(full_reg_data, 'sum_ge_16~p_min_e');

sum_gd_4_pe = fitlm(full_reg_data, 'sum_gd_4~p_min_e');
sum_gd_8_pe = fitlm(full_reg_data, 'sum_gd_8~p_min_e');
sum_gd_12_pe = fitlm(full_reg_data, 'sum_gd_12~p_min_e');
sum_gd_16_pe = fitlm(full_reg_data, 'sum_gd_16~p_min_e');

sum_rm_4_pe = fitlm(full_reg_data, 'sum_rm_4~p_min_e');
sum_rm_8_pe = fitlm(full_reg_data, 'sum_rm_8~p_min_e');
sum_rm_12_pe = fitlm(full_reg_data, 'sum_rm_12~p_min_e');
sum_rm_16_pe = fitlm(full_reg_data, 'sum_rm_16~p_min_e');

% table 6

table_6_data = cell(11,12);
table_6_data([1:5,7:11],1) = {'Panel A: Price-dividend ratio', 4, 8, 12, 16, ...
    'Panel B: Price-earnings ratio', 4, 8, 12, 16};

table_6_data(2:5,2:4) = {...
   sum_ge_4_pd.Coefficients.Estimate(2), sum_ge_4_pd.Coefficients.tStat(2),sum_ge_4_pd.Rsquared.Adjusted;...
   sum_ge_8_pd.Coefficients.Estimate(2), sum_ge_8_pd.Coefficients.tStat(2),sum_ge_8_pd.Rsquared.Adjusted;...
   sum_ge_12_pd.Coefficients.Estimate(2), sum_ge_12_pd.Coefficients.tStat(2),sum_ge_12_pd.Rsquared.Adjusted;...
   sum_ge_16_pd.Coefficients.Estimate(2), sum_ge_16_pd.Coefficients.tStat(2),sum_ge_16_pd.Rsquared.Adjusted};

table_6_data(2:5,6:8) = {...
   sum_gd_4_pd.Coefficients.Estimate(2), sum_gd_4_pd.Coefficients.tStat(2),sum_gd_4_pd.Rsquared.Adjusted;...
   sum_gd_8_pd.Coefficients.Estimate(2), sum_gd_8_pd.Coefficients.tStat(2),sum_gd_8_pd.Rsquared.Adjusted;...
   sum_gd_12_pd.Coefficients.Estimate(2), sum_gd_12_pd.Coefficients.tStat(2),sum_gd_12_pd.Rsquared.Adjusted;...
   sum_gd_16_pd.Coefficients.Estimate(2), sum_gd_16_pd.Coefficients.tStat(2),sum_gd_16_pd.Rsquared.Adjusted};

table_6_data(2:5,10:12) = {...
   sum_rm_4_pd.Coefficients.Estimate(2), sum_rm_4_pd.Coefficients.tStat(2),sum_rm_4_pd.Rsquared.Adjusted;...
   sum_rm_8_pd.Coefficients.Estimate(2), sum_rm_8_pd.Coefficients.tStat(2),sum_rm_8_pd.Rsquared.Adjusted;...
   sum_rm_12_pd.Coefficients.Estimate(2), sum_rm_12_pd.Coefficients.tStat(2),sum_rm_12_pd.Rsquared.Adjusted;...
   sum_rm_16_pd.Coefficients.Estimate(2), sum_rm_16_pd.Coefficients.tStat(2),sum_rm_16_pd.Rsquared.Adjusted};

table_6_data(8:11,2:4) = {...
   sum_ge_4_pe.Coefficients.Estimate(2), sum_ge_4_pe.Coefficients.tStat(2),sum_ge_4_pe.Rsquared.Adjusted;...
   sum_ge_8_pe.Coefficients.Estimate(2), sum_ge_8_pe.Coefficients.tStat(2),sum_ge_8_pe.Rsquared.Adjusted;...
   sum_ge_12_pe.Coefficients.Estimate(2), sum_ge_12_pe.Coefficients.tStat(2),sum_ge_12_pe.Rsquared.Adjusted;...
   sum_ge_16_pe.Coefficients.Estimate(2), sum_ge_16_pe.Coefficients.tStat(2),sum_ge_16_pe.Rsquared.Adjusted};

table_6_data(8:11,6:8) = {...
   sum_gd_4_pe.Coefficients.Estimate(2), sum_gd_4_pe.Coefficients.tStat(2),sum_gd_4_pe.Rsquared.Adjusted;...
   sum_gd_8_pe.Coefficients.Estimate(2), sum_gd_8_pe.Coefficients.tStat(2),sum_gd_8_pe.Rsquared.Adjusted;...
   sum_gd_12_pe.Coefficients.Estimate(2), sum_gd_12_pe.Coefficients.tStat(2),sum_gd_12_pe.Rsquared.Adjusted;...
   sum_gd_16_pe.Coefficients.Estimate(2), sum_gd_16_pe.Coefficients.tStat(2),sum_gd_16_pe.Rsquared.Adjusted};

table_6_data(8:11,10:12) = {...
   sum_rm_4_pe.Coefficients.Estimate(2), sum_rm_4_pe.Coefficients.tStat(2),sum_rm_4_pe.Rsquared.Adjusted;...
   sum_rm_8_pe.Coefficients.Estimate(2), sum_rm_8_pe.Coefficients.tStat(2),sum_rm_8_pe.Rsquared.Adjusted;...
   sum_rm_12_pe.Coefficients.Estimate(2), sum_rm_12_pe.Coefficients.tStat(2),sum_rm_12_pe.Rsquared.Adjusted;...
   sum_rm_16_pe.Coefficients.Estimate(2), sum_rm_16_pe.Coefficients.tStat(2),sum_rm_16_pe.Rsquared.Adjusted};


clf

f6 = figure('Name','Price-earnings ratios and economic uncertainty: USA','NumberTitle','off');


f6.Position = [560,528,840,270];

table_6 = uitable(f6,'Data',table_6_data,'Position',[20 30 805 235]);
table_6.Position = [20 30 805 235];

table_6.ColumnWidth = {140,65,65,65,20,65,65,65,20,65,65,65};
table_6.ColumnName = {'J', 'beta_J', 't-stat', 'R^2', [], 'beta_J', 't-stat', 'R^2', [],'beta_J', 't-stat', 'R^2'};



##### SOURCE END #####
--></body></html>